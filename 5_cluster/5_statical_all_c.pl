#!usr/bin/perl -w
$string=$ARGV[0];
$dir="$string/sort_in_chr";#输入文件路径，
$dir2="$string/cluster";#info和info_2等临时文件将输出到$dir路径
$dir1="/home/storage/lung/hg19";#基因组序列所在文件夹
opendir (DIR,$dir) or die("Can't open the dictionary!");
@dir=readdir DIR;
foreach $file (@dir){
	$file_name="";
	if($file=~/^sort_in_chr/){
  		@name1=split/_/,$file;
  		@name2=split/\./,$name1[3];
		$run=$name2[0];
		$file_name=$name1[2];
		open(IN,"$dir/$file");
	   open(OUT,">$dir2/$file_name\_resort_info.txt");
		$sum=0;
		$minus[0]=0;
		$minus[1]=0;
		$site[0]=0;
 		$site[1]=0;
 		$length_1=0;
 		$length_2=0;
		$t=0;
		$flag=0;
  		$a=-1;                                               
  		while($rd=<IN>){
			$t++;
			$flag++;
			chomp $rd;
			@rd=split/\s+/,$rd;
			$temp=$rd[9];         #掉换字段顺序
			$rd[9]=$rd[8];
			$rd[8]=$rd[7];
			$rd[7]=$rd[6];
			$rd[6]=$rd[5];
			$rd[5]=$rd[4];
			$rd[4]=$rd[3];
			$rd[3]=$rd[2];
			$rd[2]=$rd[1];
			$rd[1]=$rd[0];
			$rd[0]=$temp;
			$rd1=join("	",@rd);
	
			if($flag==1){		
				$site[0]=$rd[4];
				$length_1=length($rd[0])+$rd[4];
#				$length_1_1=length($rd[0]);
				$minus[0]=$rd[4]-$site[1];	
#				if($minus[0]>=0 && $minus[0]<=35){
				if($rd[4]<=$length_2){
					$c++;
#					$sum+=$minus[0];
#					$tt[0]=substr($space,0,$sum).$rd1;
				}else{			
					$a++;
#					$tt[0]=$rd1;
#					$sum=0;
					$minus[0]=0;
					$minus[1]=0;
					$b=$length_2-1;					#上一个读段+47	/32		
					if($t!=1){
						print OUT ">$rd[3]_$temp1-$b"."	"."ID:$a"."	"."reads:$c\n";
#						for($i=1;$i<=$c;$i++){
#							print OUT "$arr[$i]\n";
#						}
					}
					$c=1;
					@arr="";
					$temp1=$site[0];#保存第一个读段的坐标.									
				}
#				$arr[$c]=$tt[0];#保存每个读段.
			}
	
			if($flag==2){
				$flag=0;
				$site[1]=$rd[4];
				$length_2=length($rd[0])+$rd[4];
				$minus[1]=$site[1]-$site[0];
				if($rd[4]<=$length_1){	
					$c++;
#					$sum+=$minus[1];
#					$tt[1]=substr($space,0,$sum).$rd1;
				}else{
					$a++;
#					$tt[1]=$rd1;
#					$sum=0;
					$minus[0]=0;
					$minus[1]=0;
					$b=$length_1-1;
					print OUT ">$rd[3]_$temp1-$b"."	"."ID:$a"."	"."reads:$c\n";
#					for($i=1;$i<=$c;$i++){
#						print OUT "$arr[$i]\n";
#					}
					$c=1;
					@arr="";
					$temp1=$site[1];
				}
#				$arr[$c]=$tt[1];
			}
 		}
		$mm=$rd[4]+length($rd[0])-1;
		$a++;
		print OUT ">$rd[3]_$temp1-$mm	ID:$a	reads:$c\n";
		close IN;
		close OUT;
		#预处理1完成

		$a0=-1;		
		open IN0,"$dir1/$file_name.fa";#读取染色体序列，存到计算机内存
		while(<IN0>){
			chomp;
			$a0++;#a0=0时，存储>chrY行;a>0时存储序列
			$refseq[$a0]=uc $_;
		}
		close IN0;

		open IN00,"$dir2/$file_name\_resort_info.txt";#打开聚类info文件
		open OUT00,">$dir2/$file_name\_resort_info_2.txt";#输出info_2.txt
		$temp_start=1;#标志符，在for循环中使用
		while($rd=<IN00>){
			chomp $rd;
			$t=0;
			@rd=split/\s+/,$rd;
			@rd0=split/_/,$rd[0];
			@ends=split/-/,$rd0[1];#分割后得到该类的坐标范围
			
			$p1=$ends[0];#坐标起始
			$p2=$ends[1];#坐标终止
			if($p1%50!=0){
				$line1=int($p1/50)+1;#基因组序列起始行
				$site1=$p1%50-1;#起始行的碱基开始位置
			}else{
				$line1=$p1/50;
				$site1=49;
			}
			if($p2%50!=0){
				$line2=int($p2/50)+1;#基因组序列终止行
				$site2=$p2%50;#终止行的碱基终止位置
			}else{
				$line2=$p2/50;
				$site2=50;
			}
			for($i=$temp_start;$i<=$a0;$i++){
				if($i>=$line1 && $i<=$line2){#基因组文件中的第i行，在聚类范围内
					$t++;#记录行数
					if($i==$line1){#第一行需要考虑碱基开始坐标
						if($line1==$line2){#line1和line2是在同一行，只需要从基因组第i行中提取出碱基序列
							$base_num=$p2-$p1+1;#开始碱基与终止碱基的坐标差
							$tt[$t]=substr($refseq[$i],$site1,$base_num);#从基因组上提取该段碱基序列
						}else{#不在同一行，保存第line1行中的部分序列
							$tt[$t]=substr($refseq[$i],$site1);
						}
					}elsif($i>$line1 && $i<$line2){#i在line1和line2中间，直接保存该行
						$tt[$t]=$refseq[$i];
					}elsif($i==$line2){#最后一行需要考虑碱基终止坐标
						$tt[$t]=substr($refseq[$i],0,$site2);
						$temp_start=$i-2;#为下一个for循环作初始化，从该行往下搜索
						last;
					}
				}elsif($i>$line2){#找过了，直接跳出。正常不会出现这种情况
					$temp_start=$i-2;
					last;
				}else{#i<line1，还没找到，i++，继续往下搜索
					next;
				}		
			}
			print OUT00 "$rd\t";#输出info.txt中的行
			for($j=1;$j<=$t;$j++){
				print OUT00 "$tt[$j]";#在该行后面接着输出基因组序列
			}
			print OUT00 "\n";
			$t=0;
			@tt="";						
		}
		@refseq="";#释放内存
		close IN00;
		close OUT00;
		#----------------------------------预处理2完成，已经生成info_2.txt，带有基因组序列
		#----------------------------------开始聚类

		open IN1,"$dir2/$file_name\_resort_info_2.txt";
		$num=0;
		while($ln=<IN1>){
			chomp $ln;
			$num++;
			$z[$num]=$ln;
		}
		close IN1;
		open(IN2,"$dir/sort_in_$file_name\_$run\.txt");
		open(OUT2,">$dir2/$file_name\_resort_$run\.txt");
	print "$file_name\_resort_$run\.txt\n";	$space="                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ";
		$sum=0;
		$minus[0]=0;
		$minus[1]=0;
		$site[0]=0;
		$site[1]=0;
		$length_1=0;
		$length_2=0;
		$flag=0;
		$c=0;
		#$a=-1; 
		$a=0;                                              
		while($rd=<IN2>){
		#	$t++;
			$flag++;
			chomp $rd;
			@rd=split/\s+/,$rd;
			$temp=$rd[9];
			$rd[9]=$rd[8];
			$rd[8]=$rd[7];
			$rd[7]=$rd[6];
			$rd[6]=$rd[5];
			$rd[5]=$rd[4];
			$rd[4]=$rd[3];
			$rd[3]=$rd[2];
			$rd[2]=$rd[1];
			$rd[1]=$rd[0];
			$rd[0]=$temp;
			$rd1=join("	",@rd);
	
			if($flag==1){		
				$site[0]=$rd[4];
				$length_1=length($rd[0])+$rd[4];
				$minus[0]=$rd[4]-$site[1];	
				if($rd[4]<=$length_2){
					$c++;
					$sum+=$minus[0];
					$tt[0]=substr($space,0,$sum).$rd1;
					print OUT2 "$tt[0]\n";
				}else{			
					$a++;
#					print "z:$z[$a],a=$a\n";
					print OUT2 "$z[$a]\n";
					$tt[0]=$rd1;
					print OUT2 "$tt[0]\n";
					$sum=0;
					$minus[0]=0;
					$minus[1]=0;
					$b=$length_2-1;					#上一个读段+47	/32		
					$c=1;
					@arr="";
					$temp1=$site[0];#保存第一个读段的坐标.									
				}
			}
	
			if($flag==2){
				$flag=0;
				$site[1]=$rd[4];
				$length_2=length($rd[0])+$rd[4];
				$minus[1]=$site[1]-$site[0];
				if($rd[4]<=$length_1){	
					$c++;
					$sum+=$minus[1];
					$tt[1]=substr($space,0,$sum).$rd1;
					print OUT2 "$tt[1]\n";
				}else{
					$a++;
#					print "z:$z[$a],a=$a\n";
					print OUT2 "$z[$a]\n";
					$tt[1]=$rd1;
					print OUT2 "$tt[1]\n";
					$sum=0;
					$minus[0]=0;
					$minus[1]=0;
					$b=$length_1-1;
					$c=1;
					@arr="";
					$temp1=$site[1];
				}
			}
		}
		close IN2;
		close OUT2;
	}else{
		next;
	}
}	
